{"ast":null,"code":"export default {\n  name: 'MyCart',\n  props: {\n    tableData: Array\n  },\n\n  data() {\n    return {\n      search: ''\n    };\n  },\n\n  methods: {\n    handleBuy(row) {\n      this.$confirm('确定购买该商品吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        const params = new URLSearchParams();\n        params.append('name', row.name);\n        params.append('price', row.price);\n        params.append('id', row.id);\n        this.$http.post('/api/mall/addGoods', params).then(() => {\n          this.$http.post('/api/mall/deleteCart', params).then(() => {\n            // 向父组件请求更新数据\n            this.$emit('updateCart');\n            this.$emit('updateMyGoods');\n            this.$message({\n              message: '购买成功',\n              type: 'success'\n            });\n          }).catch(error => {\n            console.log(error);\n            this.$message.error('购买成功但购物车删除失败');\n          });\n        }).catch(error => {\n          console.log(error);\n          this.$message.error('添加失败');\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消购买'\n        });\n      });\n    },\n\n    handleDelete(row) {\n      this.$confirm('确定删除该商品吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 发送请求，让数据库删除数据\n        const params = new URLSearchParams();\n        params.append('id', row.id);\n        this.$http.post('/api/mall/deleteCart', params).then(() => {\n          // 向父组件请求更新数据\n          this.$emit('updateCart');\n          this.$message({\n            message: '删除成功',\n            type: 'success'\n          });\n        }).catch(error => {\n          console.log(error);\n          this.$message.error('删除失败');\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAgDA;EACAA,cADA;EAEAC;IACAC;EADA,CAFA;;EAKAC;IACA;MACAC;IADA;EAGA,CATA;;EAUAC;IACAC;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACA;QACAC;QACAA;QACAA;QACA,8CACAD,IADA,CACA;UACA,gDACAA,IADA,CACA;YACA;YACA;YACA;YACA;cACAE,eADA;cAEAH;YAFA;UAIA,CATA,EASAI,KATA,CASAC;YACAC;YACA;UACA,CAZA;QAaA,CAfA,EAeAF,KAfA,CAeAC;UACAC;UACA;QACA,CAlBA;MAmBA,CA5BA,EA4BAF,KA5BA,CA4BA;QACA;UACAJ,YADA;UAEAG;QAFA;MAIA,CAjCA;IAkCA,CApCA;;IAqCAI;MACA;QACAT,uBADA;QAEAC,sBAFA;QAGAC;MAHA,GAIAC,IAJA,CAIA;QACA;QACA;QACAC;QACA,gDACAD,IADA,CACA;UACA;UACA;UACA;YACAE,eADA;YAEAH;UAFA;QAIA,CARA,EASAI,KATA,CASAC;UACAC;UACA;QACA,CAZA;MAaA,CArBA,EAqBAF,KArBA,CAqBA;QACA;UACAJ,YADA;UAEAG;QAFA;MAIA,CA1BA;IA2BA;;EAjEA;AAVA","names":["name","props","tableData","data","search","methods","handleBuy","confirmButtonText","cancelButtonText","type","then","params","message","catch","error","console","handleDelete"],"sourceRoot":"src/views/user/cart","sources":["myCart.vue"],"sourcesContent":["<template>\n    <div>\n        <el-container>\n            <el-main>\n                <el-table\n                :data=\"tableData.filter(data => !search || data.name.toLowerCase().includes(search.toLowerCase()))\"\n                max-height = \"600\"\n                border\n                style=\"width: 100%\">\n                    <!--每行输出的内容-->\n                    <el-table-column\n                    label=\"名称\"\n                    width=\"200\"\n                    prop=\"name\">\n                    </el-table-column>\n                    <el-table-column\n                    label=\"价格\"\n                    width=\"200\"\n                    prop=\"price\">\n                    </el-table-column>\n                    <el-table-column\n                    fixed=\"right\"\n                    width=\"280\"\n                    align=\"center\">\n                        <!--搜索框，注意一定要#header，不能写v-slot，不然有显示问题-->\n                        <template #header>\n                            <el-input\n                            v-model=\"search\"\n                            placeholder=\"输入名称搜索\"\n                            ></el-input>\n                        </template>\n                        <!--编辑与删除按钮-->\n                        <template slot-scope=\"scope\">\n                            <el-button\n                            type=\"primary\"\n                            @click=\"handleBuy(scope.row)\">购买</el-button>\n                            <el-button\n                            type=\"danger\"\n                            @click=\"handleDelete(scope.row)\">删除</el-button>\n                        </template>\n                    </el-table-column>\n                </el-table>\n            </el-main>\n        </el-container>\n    </div>\n</template>\n\n<script>\nexport default {\n  name: 'MyCart',\n  props: {\n    tableData: Array\n  },\n  data () {\n    return {\n      search: ''\n    }\n  },\n  methods: {\n    handleBuy (row) {\n      this.$confirm('确定购买该商品吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        const params = new URLSearchParams()\n        params.append('name', row.name)\n        params.append('price', row.price)\n        params.append('id', row.id)\n        this.$http.post('/api/mall/addGoods', params)\n          .then(() => {\n            this.$http.post('/api/mall/deleteCart', params)\n              .then(() => {\n                // 向父组件请求更新数据\n                this.$emit('updateCart')\n                this.$emit('updateMyGoods')\n                this.$message({\n                  message: '购买成功',\n                  type: 'success'\n                })\n              }).catch((error) => {\n                console.log(error)\n                this.$message.error('购买成功但购物车删除失败')\n              })\n          }).catch((error) => {\n            console.log(error)\n            this.$message.error('添加失败')\n          })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消购买'\n        })\n      })\n    },\n    handleDelete (row) {\n      this.$confirm('确定删除该商品吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 发送请求，让数据库删除数据\n        const params = new URLSearchParams()\n        params.append('id', row.id)\n        this.$http.post('/api/mall/deleteCart', params)\n          .then(() => {\n            // 向父组件请求更新数据\n            this.$emit('updateCart')\n            this.$message({\n              message: '删除成功',\n              type: 'success'\n            })\n          })\n          .catch((error) => {\n            console.log(error)\n            this.$message.error('删除失败')\n          })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]},"metadata":{},"sourceType":"module"}